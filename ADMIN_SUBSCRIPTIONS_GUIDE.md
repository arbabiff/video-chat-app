# 📘 راهنمای مدیریت اشتراک‌ها در پنل ادمین

این راهنما نحوه راه‌اندازی، مشاهده و مدیریت سه اشتراک در پنل ادمین را توضیح می‌دهد.

---

## 🚀 مراحل راه‌اندازی

### 1️⃣ نصب وابستگی‌ها

**بکند:**
```powershell
cd D:\oflline-MG\video-chat-original\backend
npm install
```

**فرانت‌اند:**
```powershell
cd D:\oflline-MG\video-chat-original
npm install
```

---

### 2️⃣ راه‌اندازی بکند

یک ترمینال جداگانه باز کنید و دستور زیر را اجرا کنید:

```powershell
cd D:\oflline-MG\video-chat-original\backend
node server.js
```

یا با متغیر محیطی پورت:
```powershell
$env:PORT=5000
node server.js
```

باید پیامی شبیه این ببینید:
```
🚀 Server running on port 5000
✅ Database connected
```

---

### 3️⃣ راه‌اندازی فرانت‌اند

یک ترمینال جدید دیگر باز کنید:

```powershell
cd D:\oflline-MG\video-chat-original
npm run dev
```

برنامه روی `http://localhost:5173` اجرا می‌شود.

---

## 🔐 ورود به پنل ادمین

### روش اصلی (بدون نیاز به لاگین)
مستقیماً به آدرس زیر بروید:
```
http://localhost:3000/admin.html
```
یا:
```
http://localhost:3001/admin
```

**توجه:** پنل ادمین بدون نیاز به لاگین باز می‌شود و مستقیماً به `AdminPanel` متصل است.

### روش جایگزین (با لاگین)
اگر می‌خواهید از صفحه لاگین استفاده کنید:
1. به آدرس `http://localhost:3000/admin-login.html` بروید
2. شماره تلفن ادمین: `09547646475`
3. پس از ورود، به پنل ادمین هدایت می‌شوید

---

## 📋 مشاهده و مدیریت اشتراک‌ها

### دسترسی به بخش اشتراک‌ها
1. در منوی سمت راست پنل ادمین، گزینه **"مدیریت اشتراک‌ها"** را کلیک کنید
2. صفحه مدیریت اشتراک‌ها باز می‌شود

---

## 📦 سه اشتراک موجود

هم‌اکنون **3 اشتراک** در سیستم وجود دارد:

### ✅ اشتراک 1: یک ماهه
- **قیمت:** 150,000 تومان
- **مدت:** 30 روز
- **ویژگی‌ها:**
  - تصویر با کیفیت بالا
  - قابلیت قفل ۲ دقیقه‌ای
  - ادامه ارتباط بالای ۳ دقیقه
  - ۱۰ قفل ماهانه

### ✅ اشتراک 2: شش ماهه
- **قیمت:** 630,000 تومان
- **مدت:** 180 روز
- **ویژگی‌ها:**
  - تمام مزایای ماهانه
  - ۳۰٪ تخفیف
  - پشتیبانی اولویت‌دار
  - ۶۰ قفل (۶ ماه)

### ✅ اشتراک 3: سالانه
- **قیمت:** 900,000 تومان
- **مدت:** 365 روز
- **ویژگی‌ها:**
  - تمام مزایای ماهانه
  - ۵۰٪ تخفیف
  - قفل نامحدود
  - ۱۲۰ قفل (۱ سال)

---

## ⚙️ عملیات‌های مدیریت

### 1️⃣ ویرایش اشتراک

**مراحل:**
1. روی آیکون **مداد** (Edit) در کنار اشتراک مورد نظر کلیک کنید
2. مودال ویرایش باز می‌شود
3. فیلدهای قابل ویرایش:
   - نام اشتراک
   - قیمت (تومان)
   - مدت (روز)
   - توضیحات
   - ویژگی‌ها (هر خط یک ویژگی)
   - تعداد قفل هدیه
   - کیفیت ویدیو (SD, HD, FHD, UHD)
   - زمان نامحدود
   - قابل هدیه دادن
4. روی دکمه **"ذخیره"** کلیک کنید
5. تغییرات بلافاصله اعمال می‌شود

**مثال:**
برای تغییر قیمت اشتراک یک ماهه به 180,000 تومان:
- روی آیکون ویرایش کلیک کنید
- قیمت را به `180000` تغییر دهید
- ذخیره کنید

---

### 2️⃣ حذف اشتراک

**مراحل:**
1. روی آیکون **سطل زباله** (Delete) کلیک کنید
2. پیام تأییدی نمایش داده می‌شود:
   ```
   آیا از حذف این اشتراک مطمئن هستید؟
   ```
3. روی **"تأیید"** کلیک کنید
4. اشتراک حذف می‌شود

**⚠️ هشدار:** حذف اشتراک دائمی است و قابل بازگشت نیست!

---

### 3️⃣ فعال/غیرفعال کردن اشتراک

**مراحل:**
1. روی آیکون **چشم** (Eye) کلیک کنید
2. وضعیت اشتراک تغییر می‌کند:
   - **چشم باز (سبز):** اشتراک فعال است
   - **چشم بسته (خاکستری):** اشتراک غیرفعال است
3. اشتراک‌های غیرفعال در اپلیکیشن نمایش داده نمی‌شوند

---

### 4️⃣ افزودن اشتراک جدید

**مراحل:**
1. روی دکمه **"+ اشتراک جدید"** در بالای صفحه کلیک کنید
2. فرم ایجاد اشتراک باز می‌شود
3. فیلدهای ضروری:
   - نام اشتراک (مثلاً: "اشتراک سه ماهه")
   - قیمت (مثلاً: 400000)
   - مدت (مثلاً: 90)
   - توضیحات
   - ویژگی‌ها (هر خط یک مورد)
4. فیلدهای اختیاری:
   - تعداد قفل هدیه
   - کیفیت ویدیو
   - چک‌باکس‌ها
5. روی **"ذخیره"** کلیک کنید

**مثال:**
```
نام: اشتراک سه ماهه
قیمت: 400000
مدت: 90
توضیحات: اشتراک سه ماهه با تخفیف ویژه
ویژگی‌ها:
تمام مزایای ماهانه
15% تخفیف
30 قفل در 3 ماه
```

---

## 🧪 تست API با Postman یا cURL

### دریافت همه اشتراک‌ها
```bash
curl http://localhost:5000/api/subscriptions
```

**پاسخ مورد انتظار:**
```json
{
  "success": true,
  "data": [
    {
      "id": 1,
      "name": "اشتراک یک ماهه",
      "price": 150000,
      "duration": 30,
      "features": ["..."],
      "active": true,
      ...
    },
    {
      "id": 2,
      "name": "اشتراک شش ماهه",
      "price": 630000,
      "duration": 180,
      ...
    },
    {
      "id": 3,
      "name": "اشتراک سالانه",
      "price": 900000,
      "duration": 365,
      ...
    }
  ]
}
```

### ویرایش اشتراک (نیاز به توکن ادمین)
```bash
curl -X PATCH http://localhost:5000/api/subscriptions/1 \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"price": 180000}'
```

### حذف اشتراک (نیاز به توکن ادمین)
```bash
curl -X DELETE http://localhost:5000/api/subscriptions/1 \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN"
```

---

## 📍 مسیر فایل‌ها

### بکند:
```
D:\oflline-MG\video-chat-original\backend\routes\subscriptions.js
```
👉 در این فایل اشتراک‌ها تعریف شده‌اند (خطوط 11-72)

### فرانت‌اند:
```
D:\oflline-MG\video-chat-original\src\components\AdminPanel.tsx
```
👉 در این فایل UI مدیریت اشتراک‌ها پیاده‌سازی شده است (خطوط 306-673)

### API Service:
```
D:\oflline-MG\video-chat-original\src\services\adminApi.ts
```
👉 این فایل توابع API برای مدیریت اشتراک‌ها را فراهم می‌کند (خطوط 40-91)

---

## ✅ چک‌لیست راه‌اندازی

- [ ] نصب وابستگی‌های بکند
- [ ] نصب وابستگی‌های فرانت‌اند
- [ ] راه‌اندازی سرور بکند (port 5000)
- [ ] راه‌اندازی سرور فرانت‌اند (port 5173)
- [ ] ورود به پنل ادمین با شماره 09547646475
- [ ] باز کردن بخش "مدیریت اشتراک‌ها"
- [ ] مشاهده 3 اشتراک موجود
- [ ] تست ویرایش یک اشتراک
- [ ] تست فعال/غیرفعال کردن
- [ ] تست افزودن اشتراک جدید

---

## ❓ عیب‌یابی

### اشتراک‌ها نمایش داده نمی‌شوند
**راه‌حل:**
1. اطمینان حاصل کنید که سرور بکند در حال اجرا است
2. کنسول مرورگر را بررسی کنید (F12)
3. بررسی کنید که API پاسخ می‌دهد:
   ```bash
   curl http://localhost:5000/api/subscriptions
   ```

### خطای "دسترسی مجاز نیست"
**راه‌حل:**
1. مطمئن شوید که با حساب ادمین وارد شده‌اید
2. توکن ادمین را بررسی کنید (localStorage در DevTools)
3. مجدداً وارد شوید

### تغییرات ذخیره نمی‌شوند
**راه‌حل:**
1. کنسول مرورگر را برای خطاها بررسی کنید
2. اطمینان حاصل کنید که تمام فیلدهای ضروری پر شده‌اند
3. مجدداً سعی کنید

---

## 📞 اطلاعات بیشتر

برای جزئیات بیشتر در مورد ساختار اشتراک‌ها، فایل `SUBSCRIPTIONS_INFO.md` را مطالعه کنید.

---

**تاریخ:** 2025-10-03  
**وضعیت:** ✅ آماده برای استفاده

